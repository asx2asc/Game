/* --- General App Structure --- */
body {
    font-family: 'Roboto', Arial, sans-serif; /* Changed default font */
    display: flex;
    justify-content: center;
    align-items: flex-start;
    min-height: 100vh;
    background-color: #333; /* Darker default background for contrast */
    margin: 0;
    padding: 20px;
    box-sizing: border-box;
    user-select: none;
    overflow-x: hidden;
}

#app-container {
    width: 100%;
    max-width: 1000px;
    margin: auto;
    position: relative; /* For absolutely positioned tooltips/overlays */
}

/* --- Phase 0: Main Menu Screen --- */
#main-menu-screen {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 80vh;
    padding: 20px;
    border-radius: 10px;
    text-align: center;
    box-shadow: 0 0 30px rgba(0,0,0,0.5);
    position: relative; /* For background */
    overflow: hidden; /* If background animates */
    background-color: #ffeb3b; /* Fallback if image fails */
}

.main-menu-background {
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    z-index: 0;
    background-image: url('assets/images/menu_background_illustrative.jpg'); /* CREATE THIS ASSET */
    background-size: cover;
    background-position: center;
    /* animation: subtleMenuPan 80s linear infinite alternate; */
}
/* @keyframes subtleMenuPan {
    from { background-position-x: 0%; }
    to { background-position-x: 100%; }
} */

#game-logo {
    max-width: 350px; /* Slightly larger */
    margin-bottom: 40px;
    filter: drop-shadow(3px 3px 5px rgba(0,0,0,0.3));
    position: relative; z-index: 1;
    /* Use a chunky, thematic font if logo is text-based and styled via CSS:
    font-family: 'Bangers', cursive;
    font-size: 4em; color: #ff5722; text-stroke: 2px black; */
}

.menu-buttons {
    display: flex;
    flex-direction: column;
    gap: 15px;
    position: relative; z-index: 1;
}

.menu-button {
    padding: 15px 30px;
    font-size: 1.2em;
    font-family: 'Luckiest Guy', cursive; /* Thematic button font */
    color: #fff;
    background-color: #ff5722;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: background-color 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
    box-shadow: 0 4px 6px rgba(0,0,0,0.2), inset 0 -2px 0 rgba(0,0,0,0.2); /* 2.5D feel */
    text-transform: uppercase;
    letter-spacing: 1px;
}

.menu-button:hover {
    background-color: #e64a19;
    transform: translateY(-3px) scale(1.03);
    box-shadow: 0 6px 10px rgba(0,0,0,0.3), inset 0 -1px 0 rgba(0,0,0,0.1);
}

.menu-button:active {
    background-color: #d84315;
    transform: translateY(1px) scale(0.98);
    box-shadow: 0 2px 3px rgba(0,0,0,0.2), inset 0 -1px 0 rgba(0,0,0,0.3);
}

/* Specific Menu Button Colors */
#how-to-play-btn, #settings-btn, #pawn-customization-ui button, #ai-selection-ui button {
    background-color: #03a9f4; font-size: 1em;
}
#how-to-play-btn:hover, #settings-btn:hover { background-color: #0288d1; }
#how-to-play-btn:active, #settings-btn:active { background-color: #0277bd; }

#quit-btn { background-color: #757575; font-size: 1em; padding: 10px 20px;}
#quit-btn:hover { background-color: #616161; }
#quit-btn:active { background-color: #424242; }

/* Pawn Customization & AI Selection UI */
.pawn-options { display: flex; align-items: center; justify-content: center; gap: 10px; }
.pawn-option-btn {
    padding: 8px; min-width: 30px; height: 30px; border: 2px solid transparent;
    border-radius: 4px; cursor: pointer; display:flex; align-items:center; justify-content:center;
}
.pawn-option-btn.selected { border-color: #ffeb3b; box-shadow: 0 0 5px #ffeb3b; }
.pawn-color-btn { width: 30px; }
#pawn-preview-marker img { width: 100%; height: 100%; object-fit: contain; }
.menu-select, .menu-slider { margin-left: 10px; padding: 5px; border-radius: 4px; border: 1px solid #ccc; }


/* --- Game Screen --- */
#game-container {
    background-color: #fff; /* Fallback for game board surface */
    background-image: url('assets/textures/game_board_main_texture.png'); /* CREATE THIS: subtle main board texture */
    background-size: cover;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 0 20px rgba(0,0,0,0.3);
    width: 100%;
    max-width: 900px;
    text-align: center;
    position: relative;
    transition: transform 0.4s ease-out; /* For zoom focus */
}
#game-container.game-ended-focus-zoom {
    /* Example: transform: scale(1.1) translateY(-50px); */
    /* JS will need to calculate transform to focus on finish line */
}

/* --- Information/Message Bar --- */
#info-message-bar {
    background-color: rgba(0, 0, 0, 0.75);
    color: white;
    padding: 12px 15px;
    text-align: center;
    font-size: 1.1em;
    border-radius: 5px;
    margin-bottom: 15px;
    font-family: 'Roboto', sans-serif;
    min-height: 1.5em; /* Prevent layout shift */
    display:flex; align-items:center; justify-content:center;
}
#info-message-bar p { margin: 0; }

/* --- Scoreboard Enhancements --- */
#score-board {
    margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px solid #eee;
    font-size: 1.1em;
}
#score-board p { margin: 5px 0; }
#score-board span { font-weight: bold; }
.map-total-spaces { font-weight: normal; color: #555; }

/* --- AI Player Status Area --- */
#ai-player-status-area {
    display: flex; justify-content: center; /* Only one AI for now */
    margin-bottom: 20px; padding: 10px;
    background-color: rgba(248,249,250, 0.8); border-radius: 6px;
}
.ai-player-panel {
    border: 2px solid #ccc; border-radius: 8px; padding: 10px;
    text-align: center; width: 150px; background-color: #fff;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    perspective: 800px; /* For 3D flip of bet indicator */
}
.ai-player-panel.ai-type-robot { /* Example for themed border */
    border: 3px solid #78909c;
    box-shadow: inset 0 0 3px rgba(255,255,255,0.3), 0 1px 0 #bbb, 0 2px 4px rgba(0,0,0,0.1);
}
.ai-player-panel.ai-type-sheep { /* Placeholder for complex border */
    border: 5px solid transparent;
    /* border-image: url('assets/borders/woolly_border.png') 10 round; CREATE THIS */
    background-color: #f0e68c; /* Khaki to simulate wool */
}
.ai-avatar {
    width: 70px; height: 70px; border-radius: 50%;
    background-color: #eee; margin: 0 auto 8px auto; display: block;
    object-fit: cover; border: 2px solid white; box-shadow: 0 1px 3px rgba(0,0,0,0.2);
}
.ai-player-panel.thinking .ai-avatar { animation: aiThinking 1s infinite ease-in-out; }
@keyframes aiThinking { /* More expressive thinking */
    0%, 100% { transform: rotate(-4deg) scale(1); }
    50% { transform: rotate(4deg) scale(1.05); }
}
.ai-name { font-weight: bold; font-size: 1em; margin-bottom: 5px; }
.ai-pawn-miniature {
    width: 25px; height: 25px; border-radius: 50%; margin: 5px auto;
    line-height: 25px; font-size: 0.9em; font-weight: bold; color: white;
    background-color: #dc3545; display:flex; align-items:center; justify-content:center;
}
.ai-pawn-miniature img { max-width: 90%; max-height: 90%; }

.ai-bet-indicator { /* Base style for '?' and revealed number */
    font-size: 1.5em; font-weight: bold; color: #333;
    padding: 5px; border-radius: 4px; margin-top: 5px;
    min-width: 30px; min-height:30px; display: inline-flex; align-items:center; justify-content:center;
    transform-style: preserve-3d;
    transition: transform 0.5s, background-color 0.25s ease-in-out 0.25s, color 0.25s ease-in-out 0.25s;
}
.ai-bet-indicator.face-down { /* When content is '?' */
    background-color: #5A5A5A; color: #E0E0E0;
    width: 30px; height: 30px; line-height: 30px;
    border-radius: 6px;
    box-shadow: inset 1px 1px 2px rgba(0,0,0,0.4), 1px 1px 1px rgba(255,255,255,0.2);
}
.ai-bet-indicator.flipping { animation: aiBetFlip 0.5s ease-in-out forwards; }
@keyframes aiBetFlip {
    0% { transform: rotateY(0deg); }
    50% { transform: rotateY(90deg); /* JS changes content here */ }
    100% { transform: rotateY(0deg); }
}
.ai-bet-indicator.revealed-1 { background-color: #ffc107; color:black; }
.ai-bet-indicator.revealed-2 { background-color: #007bff; color:white; }
.ai-bet-indicator.revealed-3 { background-color: #28a745; color:white; }

.ai-bet-result-icon { font-size: 2em; margin-top: 5px; opacity:0; transform: scale(0.5); }
.ai-bet-result-icon.visible { animation: iconAppearStamp 0.4s ease-out forwards; }
.ai-bet-result-icon.correct::before { content: '✔'; color: green; }
.ai-bet-result-icon.incorrect::before { content: '✖'; color: red; }
@keyframes iconAppearStamp {
    0% { transform: scale(2.5) rotate(-20deg); opacity: 0; }
    70% { transform: scale(0.9) rotate(5deg); opacity: 1; }
    100% { transform: scale(1) rotate(0deg); opacity: 1; }
}


/* --- Player Hand/Betting Interface --- */
.user-command-center {
    background-image: url('assets/textures/felt_green.jpg'); /* CREATE THIS */
    background-size: cover;
    color: white; padding: 15px; border-radius: 8px; margin-bottom: 25px;
    border: 3px solid #718096;
    box-shadow: inset 0 0 10px rgba(0,0,0,0.4);
}
.user-command-center h3 { margin-top: 0; margin-bottom: 10px; text-shadow: 1px 1px 2px black; }
#token-pool {
    display: flex; justify-content: center; align-items: center;
    min-height: 70px; flex-wrap: wrap; padding: 10px;
    background-color: rgba(0,0,0,0.2); border-radius: 6px; gap: 8px;
}
.token-holster {
    width: 55px; height: 55px;
    border: 2px dashed rgba(255,255,255,0.3);
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    box-shadow: inset 1px 1px 3px rgba(0,0,0,0.3);
}
.draggable-token {
    width: 45px; height: 45px; background-color: #ffc107; color: #333;
    border: 3px solid #e0a800; border-radius: 50%;
    display: flex; justify-content: center; align-items: center;
    font-weight: bold; font-size: 1.2em;
    cursor: grab !important;
    transition: transform 0.15s ease-out, box-shadow 0.15s ease-out, opacity 0.2s ease, filter 0.2s ease;
    box-shadow: 0 3px 5px rgba(0,0,0,0.25), inset 0 -2px 1px rgba(0,0,0,0.1);
    text-shadow: 0 1px 0 rgba(255,255,255,0.3);
    /* For active pulsing in hand */
    animation-duration: 1.5s; animation-timing-function: ease-in-out; animation-iteration-count: infinite;
}
.draggable-token.active-for-betting { animation-name: tokenActivePulse; }
@keyframes tokenActivePulse {
    0%, 100% { transform: scale(1); box-shadow: 0 3px 5px rgba(0,0,0,0.25), inset 0 -2px 1px rgba(0,0,0,0.1); }
    50% { transform: scale(1.03); box-shadow: 0 4px 7px rgba(0,0,0,0.3), inset 0 -2px 1px rgba(0,0,0,0.1), 0 0 5px gold; }
}
.draggable-token:hover:not(.dragging) { /* Enhanced hover */
    box-shadow: 0 5px 10px rgba(0,0,0,0.35), inset 0 -2px 1px rgba(0,0,0,0.1), 0 0 8px #ffeb3b;
    transform: scale(1.08) translateY(-2px);
    filter: brightness(1.15);
}
.draggable-token.dragging {
    opacity: 0.6; cursor: grabbing !important;
    transform: scale(1.15) rotate(5deg);
    box-shadow: 0 8px 15px rgba(0,0,0,0.4), 0 0 5px yellow; /* Highlight while dragging */
    border: 3px solid white; /* More pronounced border */
}
.dropped-token {
    width: 35px; height: 35px; background-color: #28a745; color: white;
    border: 1px solid #1e7e34; border-radius: 50%;
    display: inline-flex; justify-content: center; align-items: center;
    font-weight: bold; margin: 3px; font-size: 0.9em; cursor: default;
    position: relative; /* For pending/locked icons */
}
.dropped-token.dropped-snap { animation: dropSnapEffect 0.3s ease-out; }
@keyframes dropSnapEffect {
    0% { transform: scale(1.2); opacity: 0.7; }
    50% { transform: scale(0.95); }
    100% { transform: scale(1); opacity: 1; }
}
.dropped-token.pending-confirmation { opacity: 0.75; }
.dropped-token.pending-confirmation::after {
    content: '⏳'; position: absolute; top: -5px; right: -5px;
    font-size: 10px; background: white; border-radius: 50%; padding: 1px 2px;
    box-shadow: 0 0 3px black;
}
.dropped-token.locked-on-card { opacity: 1; }
.dropped-token.locked-on-card::after {
    content: '🔒'; position: absolute; top: -5px; right: -5px; font-size: 10px;
    background: white; border-radius: 50%; padding: 1px 2px; box-shadow: 0 0 3px black;
}
.dropped-token.animate-lock-stamp { animation: lockStampEffect 0.25s ease-out; }
@keyframes lockStampEffect {
    0% { transform: scale(1.3); opacity: 0.6; }
    100% { transform: scale(1); opacity: 1; }
}
.dropped-token.highlight-user-choice { box-shadow: 0 0 8px 3px #FFFFAA; }


/* --- Game Board Area --- */
.game-board-surface {
    display: flex; justify-content: space-around; flex-wrap: wrap;
    margin-bottom: 25px;
    background-image: url('assets/textures/cardboard_grain.png'); /* CREATE THIS */
    background-color: #d2b48c;
    padding: 20px; border-radius: 10px;
    border: 5px solid #8b4513;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3), inset 0 0 10px rgba(0,0,0,0.1);
}
.map-track {
    flex-basis: calc(50% - 20px); min-width: 250px; padding: 15px;
    background-color: #f5f5dc; border: 2px solid #a0522d;
    border-radius: 6px; margin: 5px; box-sizing: border-box;
}
.map-label { font-weight: bold; margin-bottom: 10px; color: #495057; font-size: 1.1em; }
.map-track .track-line-container {
    width: 100%; background-color: #ffffff;
    border: 3px solid #704214; /* Darker, more defined */
    border-radius: 20px; height: 30px; position: relative;
    margin-bottom: 8px; overflow: hidden;
    box-shadow: inset 0 1px 3px rgba(0,0,0,0.2);
    /* Dashed lines for conceptual spaces */
    background-image: repeating-linear-gradient(to right,
        transparent, transparent 18px, /* Adjust segment width as needed */
        rgba(0,0,0,0.08) 18px, rgba(0,0,0,0.08) 20px
    );
}
.track-line { position: relative; width: 100%; height: 100%; }

.map-space {
    font-weight: bold; color: #fff; background-color: #607d8b;
    padding: 5px 10px; border-radius: 4px; margin: 5px 0; display: inline-block;
    font-family: 'Luckiest Guy', cursive;
}
.map-space-start { background-color: #4caf50; padding: 8px 15px; }
.map-space-start::before { content: "🏁"; margin-right: 5px; }
.map-space-finish { background-color: #f44336; }
.map-space-finish::before { content: "🏆"; margin-right: 5px; }
.map-space-finish.glowing { animation: glowingFinish 1.2s infinite ease-in-out; }
@keyframes glowingFinish {
    0%, 100% { box-shadow: 0 0 8px #f44336, 0 0 15px #f44336; text-shadow: 0 0 5px #fff; }
    50% { box-shadow: 0 0 15px #ff7961, 0 0 25px #ff7961; text-shadow: 0 0 10px #fff; }
}

.checkpoint-marker {
    position: absolute; top: 50%; transform: translateY(-50%);
    width: 28px; height: 28px; background-color: #03a9f4;
    border: 2px solid white; border-radius: 50%; z-index: 1;
    display: flex; align-items: center; justify-content: center;
    font-size: 16px; box-shadow: 0 0 5px #03a9f4;
}
.checkpoint-marker.glowing-border { animation: glowingCheckpoint 2s infinite ease-in-out; }
@keyframes glowingCheckpoint {
    0%, 100% { box-shadow: 0 0 5px #03a9f4, 0 0 10px #03a9f4; }
    50% { box-shadow: 0 0 10px #81d4fa, 0 0 18px #81d4fa; }
}
.shield-visual { /* For safe space interaction */
    position:absolute; width: 40px; height: 40px;
    border:3px solid skyblue; border-radius:50%;
    top: 50%; left: 50%; transform: translate(-50%, -50%);
    animation: shieldActivate 0.6s ease-out forwards;
    pointer-events: none; z-index: 5;
}
@keyframes shieldActivate {
    0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; border-width: 6px; }
    50% { opacity: 1; border-width: 3px; box-shadow: 0 0 15px skyblue; }
    100% { transform: translate(-50%, -50%) scale(1.5); opacity: 0; border-width: 1px; }
}


.player-marker {
    width: 32px; height: 32px;
    border-radius: 50%; color: white; text-align: center;
    font-weight: bold; font-size: 1em;
    position: absolute; top: -1px; left: 0%;
    transition: left 0.5s ease-in-out; /* Default for JS direct manipulation if not hopping */
    z-index: 2;
    box-shadow: 0 2px 4px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.3);
    animation: pawnIdle 2s infinite ease-in-out;
    background-color: transparent; /* For image pawns */
    line-height: normal;
    display: flex; align-items: center; justify-content: center;
}
.player-marker img { max-width: 100%; max-height: 100%; object-fit:contain; }
.player-marker::after { /* Glow under base */
    content: ''; position: absolute; bottom: -3px; left: 50%;
    transform: translateX(-50%); width: 20px; height: 5px;
    background: radial-gradient(ellipse at center, var(--pawn-glow-color, rgba(255,255,255,0.5)) 0%, transparent 70%);
    border-radius: 50%; z-index: -1;
}
@keyframes pawnIdle {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-3px); }
}
@keyframes pawnActivateWiggle { 0%{transform:rotate(-8deg) scale(1.1)} 50%{transform:rotate(8deg) scale(1.1)} 100%{transform:rotate(0) scale(1)} }
.player-marker.activating { animation: pawnActivateWiggle 0.3s ease-in-out; }
.player-marker.hopping-effect { /* For JS-driven hop */
    animation: pawnHopBounce 0.1s ease-out;
}
@keyframes pawnHopBounce { 0% {transform:translateY(-5px);} 100% {transform:translateY(0);} }

.pawn-trail-particle { /* For JS-driven trail */
    position: absolute; width: 8px; height: 8px; border-radius: 50%;
    opacity: 0.7; pointer-events: none;
    animation: pawnTrailFade 0.5s linear forwards;
}
@keyframes pawnTrailFade { to { opacity:0; transform: scale(0.3); } }

#human-marker { /* Default, JS overrides with playerPawnConfig */
    /* background-color: #007bff;  Now set by JS */
}
#ai-marker {
    /* background-color: #dc3545; Now set by JS for image */
}
.map-position-text { font-size: 0.95em; text-align: right; color: #495057; margin-top: 5px; }


/* --- Question Card Area --- */
#card-display-area {
    display: flex; justify-content: space-around; align-items: stretch;
    margin-bottom: 20px; min-height: 220px; /* Increased height */
    background-color: #37474f; padding: 20px; border-radius: 8px;
    box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
    position: relative; /* For deck source visuals */
    transition: transform 0.4s ease-out; /* For focus zoom */
}
#card-display-area.zoomed-in-focus { transform: scale(1.03); }
#card-display-area.is-dragging-over-cards .card-slot:not(.drag-over) {
    opacity: 0.6; transform: scale(0.98);
    transition: opacity 0.3s, transform 0.3s;
}
.deck-source-visual {
    position: absolute; width: 80px; height: 110px;
    background-color: #ccc; border: 2px solid #555; border-radius:5px;
    box-shadow: 2px 2px 5px rgba(0,0,0,0.3);
    background-image: url('assets/images/card_back_deck.png'); /* CREATE THIS */
    background-size: cover;
}
#deck-source-1 { top: -30px; left: 10%; transform: rotate(-5deg); }
#deck-source-2 { top: -40px; left: 50%; transform: translateX(-50%) rotate(2deg); }
#deck-source-3 { top: -30px; right: 10%; transform: rotate(5deg); }

.card-label { font-weight: bold; color: #cfd8dc; margin-bottom: 8px; font-size: 0.9em; text-transform: uppercase; }
.card-slot {
    border: none; border-radius: 10px; padding: 0; width: 30%;
    background-color: #546e7a;
    box-shadow: inset 2px 2px 5px rgba(0,0,0,0.3), 0 1px 0 rgba(255,255,255,0.1);
    display: flex; flex-direction: column; justify-content: space-between;
    transition: border-color 0.2s ease, box-shadow 0.2s ease, opacity 0.3s, transform 0.3s;
    position: relative;
    overflow: hidden; /* For animations */
}
.card-slot.disabled { opacity: 0.7; pointer-events: none; }
.card-slot.drag-over {
    animation: pulseCardSlotBorder 1s infinite ease-in-out;
}
@keyframes pulseCardSlotBorder {
    0% { box-shadow: 0 0 10px 3px #00A9FF, inset 2px 2px 5px rgba(0,0,0,0.3); }
    50% { box-shadow: 0 0 20px 6px #007bff, inset 2px 2px 5px rgba(0,0,0,0.3); }
    100% { box-shadow: 0 0 10px 3px #00A9FF, inset 2px 2px 5px rgba(0,0,0,0.3); }
}
.card-slot.drag-over .scenario-text {
    font-size: 1.05em; color: #FFF !important;
    transition: font-size 0.2s, color 0.2s;
}

.card-face {
    padding: 15px; min-height: 120px; display: flex; flex-direction: column;
    justify-content: space-between; position: relative; flex-grow: 1;
    background-size: cover; background-position: center; border-radius: इन्हेरिट; /* For card artwork */
}
.card-face::before { /* For empty slot pattern */
    content: ''; position: absolute; top:0; left:0; width:100%; height:100%;
    background-image: url('assets/textures/empty_card_slot_pattern.png'); /* CREATE THIS */
    background-repeat: repeat; opacity: 0.05; z-index: 0; border-radius: inherit;
    display: block;
}
.card-face.populated::before { display: none; } /* JS adds .populated */

.card-category-icon {
    position: absolute; top: 5px; left: 5px; width: 30px; height: 30px;
    z-index: 2;
    /* background-color: rgba(255,255,255,0.7); border-radius: 50%; padding:2px; */
}
.card-category-icon img { width: 100%; height: 100%; }

.card-slot .scenario-text {
    font-size: 1em; margin-bottom: 10px; flex-grow: 1; color: #eceff1;
    background-color: rgba(0,0,0,0.4); padding: 5px; border-radius: 3px; z-index: 1; position:relative;
}
.death-toll-placeholder { /* Graphic Placeholder */
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background-color: rgba(0,0,0,0.6);
    background-size: 60%; background-repeat: no-repeat; background-position: center;
    color: white; display: flex; align-items: center; justify-content: center;
    font-size: 3em; font-weight: bold; border-radius: inherit;
    transition: opacity 0.5s ease, transform 0.5s ease;
    z-index: 5;
    /* JS sets background-image: url('assets/images/placeholder_qmark_bones.png') or vault.png */
}
.death-toll-placeholder.revealing-default { /* Current animation */
    animation: placeholderDefaultReveal 0.6s forwards;
}
@keyframes placeholderDefaultReveal {
    0% { opacity: 1; transform: scale(1) rotateY(0deg); }
    100% { opacity: 0; transform: scale(1.2) rotateY(90deg); }
}
.death-toll-placeholder.revealing-shatter {
    animation: placeholderShatterReveal 0.7s forwards;
}
@keyframes placeholderShatterReveal {
    0% { opacity: 1; transform: scale(1) rotate(0); clip-path: inset(0% 0% 0% 0%); }
    50% { opacity: 0.8; transform: scale(1.1) rotate(5deg); }
    100% { opacity: 0; transform: scale(0.5) rotate(-15deg); clip-path: inset(50% 50% 50% 50%); }
}
.death-toll-placeholder.hidden { display: none !important; }

.card-slot .casualty-text {
    font-size: 1.8em; font-weight: bold; color: #ffeb3b; text-align: center;
    padding: 10px 0; margin-top: 10px; background-color: rgba(0,0,0,0.2);
    border-radius: 4px; z-index: 1;
    transition: color 0.3s;
}
/* Conditional casualty text styling */
.casualty-text.toll-low { color: #81c784; } /* Light Green */
.casualty-text.toll-mid { color: #fff176; } /* Light Yellow */
.casualty-text.toll-high { color: #e57373; } /* Light Red */
.casualty-text.toll-extreme-glow {
    text-shadow: 0 0 6px currentColor, 0 0 12px currentColor, 0 0 18px white;
}

.card-slot .dropped-token-indicator {
    margin-top: 10px; min-height: 20px; padding: 5px 0;
    font-size: 0.9em; color: #bbdefb; background-color: rgba(0,0,0,0.1);
}
.card-slot .token-count-on-card { font-weight: bold; }
.card-slot .dropped-tokens-visual-area {
    padding-top: 5px; min-height: 40px; display: flex;
    flex-wrap: wrap; justify-content: center; align-items: center;
}
.most-deaths-banner-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 10; }
.most-deaths-banner {
    position: absolute; top: -15px; left: 50%; transform: translateX(-50%) rotate(-7deg);
    background: linear-gradient(135deg, gold, orange); color: black;
    padding: 4px 15px; font-weight: bold; font-size: 0.9em; border-radius: 4px;
    box-shadow: 1px 1px 3px rgba(0,0,0,0.5);
    animation: bannerSwoopIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    font-family: 'Bangers', cursive; letter-spacing: 1px;
}
@keyframes bannerSwoopIn { from { opacity:0; transform: translateX(-50%) translateY(-30px) rotate(-20deg) scale(0.3); } }

.card-particle-container { position:absolute; top:0;left:0;width:100%;height:100%; pointer-events:none; z-index:9; }
.particle-deadliest-card { /* JS adds particles here */
    position: absolute; border-radius: 50%;
    animation: particleBurst 0.8s ease-out forwards;
}
@keyframes particleBurst {
    0% { opacity:1; transform: scale(1); }
    100% { opacity:0; transform: scale(0.3) translate(var(--tx), var(--ty)); }
}

.card-slot.dealing {
    animation: cardDealAnim 0.5s ease-out forwards;
    opacity: 0;
    transform: translateX(-100px) rotateY(-90deg); /* Start off-screen */
    /* filter: blur(2px); */ /* Motion blur during deal */
}
@keyframes cardDealAnim {
    /* ... existing, ensure it ends with filter: blur(0); */
    90% { transform: translateX(0) rotateY(0) scale(1.05); }
    100% { opacity: 1; transform: translateX(0) rotateY(0) scale(1); /* filter: blur(0); */ }
}
#card-slot-1.dealing { animation-delay: 0s; }
#card-slot-2.dealing { animation-delay: 0.2s; }
#card-slot-3.dealing { animation-delay: 0.4s; }

.card-slot.clearing.clear-fly-off { animation: cardClearFlyOff 0.5s ease-in forwards; }
@keyframes cardClearFlyOff { to { opacity: 0; transform: translateY(-150px) rotate(15deg) scale(0.7); } }
.card-slot.clearing.clear-slide-discard { animation: cardClearSlideToDiscard 0.6s ease-in forwards; }
@keyframes cardClearSlideToDiscard { to { opacity: 0; transform: translateX(150%) rotate(20deg); } }
.card-slot.clearing { /* Default clearing */ animation: cardClearAnim 0.5s ease-in forwards; }
@keyframes cardClearAnim { from { opacity: 1; transform: translateY(0) scale(1); } to { opacity: 0; transform: translateY(50px) scale(0.8); } }


.card-slot.deadliest-card {
    border: 4px solid gold !important;
    box-shadow: 0 0 15px gold, 0 0 25px gold, inset 2px 2px 5px rgba(0,0,0,0.3);
    animation: pulseGold 1s infinite;
    transform: scale(1.03); /* Slightly emphasize */
}
@keyframes pulseGold {
    0%, 100% { border-color: gold; transform: scale(1.03); }
    50% { border-color: #ffd700; transform: scale(1.05); }
}

.player-bet-indicator {
    position: absolute; top: 5px; right: 5px; font-size: 1.5em; z-index: 6;
    text-shadow: 0 0 3px black; opacity:0; transform: scale(0.5);
}
.player-bet-indicator.visible { animation: iconAppearStamp 0.4s ease-out forwards; }
.player-bet-indicator.correct::before { content: '✔'; color: lightgreen; }
.player-bet-indicator.incorrect::before { content: '✖'; color: lightcoral; }


/* --- Game Buttons --- */
button { /* General style for non-menu buttons if any left */
    padding: 10px 15px; font-size: 1em; color: #fff;
    background-color: #007bff; border: none; border-radius: 4px;
    cursor: pointer; margin: 5px;
}
button:hover { background-color: #0056b3; }
button:disabled { background-color: #ccc; cursor: not-allowed; opacity: 0.7; }

#place-bet-btn { /* Confirm Bet Button */
    padding: 12px 25px; font-size: 1.1em; background-color: #4CAF50;
    font-family: 'Luckiest Guy', cursive; text-transform: uppercase; letter-spacing: 1px;
    box-shadow: 0 3px 5px rgba(0,0,0,0.2), inset 0 -2px 0 rgba(0,0,0,0.2);
    animation-duration: 1.5s; animation-iteration-count: infinite;
}
#place-bet-btn:not(:disabled):not(.confirmed) { animation-name: pulseButtonText; }
@keyframes pulseButtonText { 0%, 100% { opacity: 1; } 50% { opacity: 0.8; } }
#place-bet-btn:hover:not(:disabled) { background-color: #45a049; transform: translateY(-2px); box-shadow: 0 5px 8px rgba(0,0,0,0.25), inset 0 -1px 0 rgba(0,0,0,0.1); }
#place-bet-btn:active:not(:disabled) { transform: translateY(1px); box-shadow: 0 2px 3px rgba(0,0,0,0.2), inset 0 -1px 0 rgba(0,0,0,0.3); }
#place-bet-btn.confirmed { background-color: #ff9800; cursor: default; }
#place-bet-btn.confirmed:hover { background-color: #f57c00; }

#next-round-btn { /* Reuse menu button style */
    /* Styles are inherited from .menu-button class in HTML */
    background-color: #28a745;
}
#next-round-btn:hover:not(:disabled) { background-color: #218838; }


/* --- AI Bet Display & Results Area --- */
#ai-bet-display, #results-area {
    margin-top: 20px; padding: 15px; background-color: rgba(233,236,239, 0.9);
    border-radius: 4px;
    transition: opacity 0.3s, transform 0.3s;
}
.fading-out-ai-info { animation: aiInfoFade 0.3s forwards; } /* JS adds this */
@keyframes aiInfoFade {to {opacity:0; transform:scale(0.8);}}
#ai-bet-display p, #results-area p { margin: 0; line-height: 1.5; }


/* --- Phase 9: Game Over Screen --- */
#game-over-screen {
    display: none; flex-direction: column; align-items: center; justify-content: center;
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background-color: rgba(0, 0, 0, 0.9); z-index: 1000;
    text-align: center; color: white; padding: 20px; box-sizing: border-box;
}
.game-over-content {
    background-color: #263238; padding: 40px; border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.5); max-width: 90%; position:relative;
}
.winner-declaration-banner {
    /* For "WINNER!" text, could be a separate graphical banner element */
}
#game-over-message {
    font-family: 'Bangers', cursive; font-size: 3.5em; /* Larger, themed */
    color: #ffeb3b; margin-bottom: 20px; text-transform: uppercase;
    word-wrap: break-word;
    text-shadow: 0 0 5px #fff, 0 0 10px #ffeb3b, 0 0 20px #ffeb3b, 0 0 30px #ff5722; /* Glow */
}
#final-scores-summary { margin-bottom: 30px; font-size: 1.2em; }
.game-over-buttons { display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; }
.game-over-buttons .menu-button { margin: 0; }

/* Confetti & Fireworks */
.confetti-container, .fireworks-container {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    overflow: hidden; pointer-events: none; z-index: -1;
}
.confetto { /* JS creates these */
    position: absolute; width: 10px; height: 10px;
    /* background-color: red; JS sets this or uses image */
    opacity: 0; animation: fall 5s linear forwards;
    background-size: contain; background-repeat: no-repeat;
}
@keyframes fall {
    0% { transform: translateY(-10vh) rotate(0deg); opacity: 1; }
    99% { opacity: 1; }
    100% { transform: translateY(110vh) rotate(720deg); opacity: 0; }
}
.firework-particle { /* JS creates these */
    position: absolute; border-radius: 50%;
    /* JS sets background, size, animation based on firework type */
}

/* Tooltip */
#game-tooltip {
    /* Styles are in HTML for now for simplicity, can move here */
}/* --- General App Structure --- */
body {
    font-family: 'Roboto', Arial, sans-serif; /* Changed default font */
    display: flex;
    justify-content: center;
    align-items: flex-start;
    min-height: 100vh;
    background-color: #333; /* Darker default background for contrast */
    margin: 0;
    padding: 20px;
    box-sizing: border-box;
    user-select: none;
    overflow-x: hidden;
}

#app-container {
    width: 100%;
    max-width: 1000px;
    margin: auto;
    position: relative; /* For absolutely positioned tooltips/overlays */
}

/* --- Phase 0: Main Menu Screen --- */
#main-menu-screen {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 80vh;
    padding: 20px;
    border-radius: 10px;
    text-align: center;
    box-shadow: 0 0 30px rgba(0,0,0,0.5);
    position: relative; /* For background */
    overflow: hidden; /* If background animates */
    background-color: #ffeb3b; /* Fallback if image fails */
}

.main-menu-background {
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    z-index: 0;
    background-image: url('assets/images/menu_background_illustrative.jpg'); /* CREATE THIS ASSET */
    background-size: cover;
    background-position: center;
    /* animation: subtleMenuPan 80s linear infinite alternate; */
}
/* @keyframes subtleMenuPan {
    from { background-position-x: 0%; }
    to { background-position-x: 100%; }
} */

#game-logo {
    max-width: 350px; /* Slightly larger */
    margin-bottom: 40px;
    filter: drop-shadow(3px 3px 5px rgba(0,0,0,0.3));
    position: relative; z-index: 1;
    /* Use a chunky, thematic font if logo is text-based and styled via CSS:
    font-family: 'Bangers', cursive;
    font-size: 4em; color: #ff5722; text-stroke: 2px black; */
}

.menu-buttons {
    display: flex;
    flex-direction: column;
    gap: 15px;
    position: relative; z-index: 1;
}

.menu-button {
    padding: 15px 30px;
    font-size: 1.2em;
    font-family: 'Luckiest Guy', cursive; /* Thematic button font */
    color: #fff;
    background-color: #ff5722;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: background-color 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
    box-shadow: 0 4px 6px rgba(0,0,0,0.2), inset 0 -2px 0 rgba(0,0,0,0.2); /* 2.5D feel */
    text-transform: uppercase;
    letter-spacing: 1px;
}

.menu-button:hover {
    background-color: #e64a19;
    transform: translateY(-3px) scale(1.03);
    box-shadow: 0 6px 10px rgba(0,0,0,0.3), inset 0 -1px 0 rgba(0,0,0,0.1);
}

.menu-button:active {
    background-color: #d84315;
    transform: translateY(1px) scale(0.98);
    box-shadow: 0 2px 3px rgba(0,0,0,0.2), inset 0 -1px 0 rgba(0,0,0,0.3);
}

/* Specific Menu Button Colors */
#how-to-play-btn, #settings-btn, #pawn-customization-ui button, #ai-selection-ui button {
    background-color: #03a9f4; font-size: 1em;
}
#how-to-play-btn:hover, #settings-btn:hover { background-color: #0288d1; }
#how-to-play-btn:active, #settings-btn:active { background-color: #0277bd; }

#quit-btn { background-color: #757575; font-size: 1em; padding: 10px 20px;}
#quit-btn:hover { background-color: #616161; }
#quit-btn:active { background-color: #424242; }

/* Pawn Customization & AI Selection UI */
.pawn-options { display: flex; align-items: center; justify-content: center; gap: 10px; }
.pawn-option-btn {
    padding: 8px; min-width: 30px; height: 30px; border: 2px solid transparent;
    border-radius: 4px; cursor: pointer; display:flex; align-items:center; justify-content:center;
}
.pawn-option-btn.selected { border-color: #ffeb3b; box-shadow: 0 0 5px #ffeb3b; }
.pawn-color-btn { width: 30px; }
#pawn-preview-marker img { width: 100%; height: 100%; object-fit: contain; }
.menu-select, .menu-slider { margin-left: 10px; padding: 5px; border-radius: 4px; border: 1px solid #ccc; }


/* --- Game Screen --- */
#game-container {
    background-color: #fff; /* Fallback for game board surface */
    background-image: url('assets/textures/game_board_main_texture.png'); /* CREATE THIS: subtle main board texture */
    background-size: cover;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 0 20px rgba(0,0,0,0.3);
    width: 100%;
    max-width: 900px;
    text-align: center;
    position: relative;
    transition: transform 0.4s ease-out; /* For zoom focus */
}
#game-container.game-ended-focus-zoom {
    /* Example: transform: scale(1.1) translateY(-50px); */
    /* JS will need to calculate transform to focus on finish line */
}

/* --- Information/Message Bar --- */
#info-message-bar {
    background-color: rgba(0, 0, 0, 0.75);
    color: white;
    padding: 12px 15px;
    text-align: center;
    font-size: 1.1em;
    border-radius: 5px;
    margin-bottom: 15px;
    font-family: 'Roboto', sans-serif;
    min-height: 1.5em; /* Prevent layout shift */
    display:flex; align-items:center; justify-content:center;
}
#info-message-bar p { margin: 0; }

/* --- Scoreboard Enhancements --- */
#score-board {
    margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px solid #eee;
    font-size: 1.1em;
}
#score-board p { margin: 5px 0; }
#score-board span { font-weight: bold; }
.map-total-spaces { font-weight: normal; color: #555; }

/* --- AI Player Status Area --- */
#ai-player-status-area {
    display: flex; justify-content: center; /* Only one AI for now */
    margin-bottom: 20px; padding: 10px;
    background-color: rgba(248,249,250, 0.8); border-radius: 6px;
}
.ai-player-panel {
    border: 2px solid #ccc; border-radius: 8px; padding: 10px;
    text-align: center; width: 150px; background-color: #fff;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    perspective: 800px; /* For 3D flip of bet indicator */
}
.ai-player-panel.ai-type-robot { /* Example for themed border */
    border: 3px solid #78909c;
    box-shadow: inset 0 0 3px rgba(255,255,255,0.3), 0 1px 0 #bbb, 0 2px 4px rgba(0,0,0,0.1);
}
.ai-player-panel.ai-type-sheep { /* Placeholder for complex border */
    border: 5px solid transparent;
    /* border-image: url('assets/borders/woolly_border.png') 10 round; CREATE THIS */
    background-color: #f0e68c; /* Khaki to simulate wool */
}
.ai-avatar {
    width: 70px; height: 70px; border-radius: 50%;
    background-color: #eee; margin: 0 auto 8px auto; display: block;
    object-fit: cover; border: 2px solid white; box-shadow: 0 1px 3px rgba(0,0,0,0.2);
}
.ai-player-panel.thinking .ai-avatar { animation: aiThinking 1s infinite ease-in-out; }
@keyframes aiThinking { /* More expressive thinking */
    0%, 100% { transform: rotate(-4deg) scale(1); }
    50% { transform: rotate(4deg) scale(1.05); }
}
.ai-name { font-weight: bold; font-size: 1em; margin-bottom: 5px; }
.ai-pawn-miniature {
    width: 25px; height: 25px; border-radius: 50%; margin: 5px auto;
    line-height: 25px; font-size: 0.9em; font-weight: bold; color: white;
    background-color: #dc3545; display:flex; align-items:center; justify-content:center;
}
.ai-pawn-miniature img { max-width: 90%; max-height: 90%; }

.ai-bet-indicator { /* Base style for '?' and revealed number */
    font-size: 1.5em; font-weight: bold; color: #333;
    padding: 5px; border-radius: 4px; margin-top: 5px;
    min-width: 30px; min-height:30px; display: inline-flex; align-items:center; justify-content:center;
    transform-style: preserve-3d;
    transition: transform 0.5s, background-color 0.25s ease-in-out 0.25s, color 0.25s ease-in-out 0.25s;
}
.ai-bet-indicator.face-down { /* When content is '?' */
    background-color: #5A5A5A; color: #E0E0E0;
    width: 30px; height: 30px; line-height: 30px;
    border-radius: 6px;
    box-shadow: inset 1px 1px 2px rgba(0,0,0,0.4), 1px 1px 1px rgba(255,255,255,0.2);
}
.ai-bet-indicator.flipping { animation: aiBetFlip 0.5s ease-in-out forwards; }
@keyframes aiBetFlip {
    0% { transform: rotateY(0deg); }
    50% { transform: rotateY(90deg); /* JS changes content here */ }
    100% { transform: rotateY(0deg); }
}
.ai-bet-indicator.revealed-1 { background-color: #ffc107; color:black; }
.ai-bet-indicator.revealed-2 { background-color: #007bff; color:white; }
.ai-bet-indicator.revealed-3 { background-color: #28a745; color:white; }

.ai-bet-result-icon { font-size: 2em; margin-top: 5px; opacity:0; transform: scale(0.5); }
.ai-bet-result-icon.visible { animation: iconAppearStamp 0.4s ease-out forwards; }
.ai-bet-result-icon.correct::before { content: '✔'; color: green; }
.ai-bet-result-icon.incorrect::before { content: '✖'; color: red; }
@keyframes iconAppearStamp {
    0% { transform: scale(2.5) rotate(-20deg); opacity: 0; }
    70% { transform: scale(0.9) rotate(5deg); opacity: 1; }
    100% { transform: scale(1) rotate(0deg); opacity: 1; }
}


/* --- Player Hand/Betting Interface --- */
.user-command-center {
    background-image: url('assets/textures/felt_green.jpg'); /* CREATE THIS */
    background-size: cover;
    color: white; padding: 15px; border-radius: 8px; margin-bottom: 25px;
    border: 3px solid #718096;
    box-shadow: inset 0 0 10px rgba(0,0,0,0.4);
}
.user-command-center h3 { margin-top: 0; margin-bottom: 10px; text-shadow: 1px 1px 2px black; }
#token-pool {
    display: flex; justify-content: center; align-items: center;
    min-height: 70px; flex-wrap: wrap; padding: 10px;
    background-color: rgba(0,0,0,0.2); border-radius: 6px; gap: 8px;
}
.token-holster {
    width: 55px; height: 55px;
    border: 2px dashed rgba(255,255,255,0.3);
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    box-shadow: inset 1px 1px 3px rgba(0,0,0,0.3);
}
.draggable-token {
    width: 45px; height: 45px; background-color: #ffc107; color: #333;
    border: 3px solid #e0a800; border-radius: 50%;
    display: flex; justify-content: center; align-items: center;
    font-weight: bold; font-size: 1.2em;
    cursor: grab !important;
    transition: transform 0.15s ease-out, box-shadow 0.15s ease-out, opacity 0.2s ease, filter 0.2s ease;
    box-shadow: 0 3px 5px rgba(0,0,0,0.25), inset 0 -2px 1px rgba(0,0,0,0.1);
    text-shadow: 0 1px 0 rgba(255,255,255,0.3);
    /* For active pulsing in hand */
    animation-duration: 1.5s; animation-timing-function: ease-in-out; animation-iteration-count: infinite;
}
.draggable-token.active-for-betting { animation-name: tokenActivePulse; }
@keyframes tokenActivePulse {
    0%, 100% { transform: scale(1); box-shadow: 0 3px 5px rgba(0,0,0,0.25), inset 0 -2px 1px rgba(0,0,0,0.1); }
    50% { transform: scale(1.03); box-shadow: 0 4px 7px rgba(0,0,0,0.3), inset 0 -2px 1px rgba(0,0,0,0.1), 0 0 5px gold; }
}
.draggable-token:hover:not(.dragging) { /* Enhanced hover */
    box-shadow: 0 5px 10px rgba(0,0,0,0.35), inset 0 -2px 1px rgba(0,0,0,0.1), 0 0 8px #ffeb3b;
    transform: scale(1.08) translateY(-2px);
    filter: brightness(1.15);
}
.draggable-token.dragging {
    opacity: 0.6; cursor: grabbing !important;
    transform: scale(1.15) rotate(5deg);
    box-shadow: 0 8px 15px rgba(0,0,0,0.4), 0 0 5px yellow; /* Highlight while dragging */
    border: 3px solid white; /* More pronounced border */
}
.dropped-token {
    width: 35px; height: 35px; background-color: #28a745; color: white;
    border: 1px solid #1e7e34; border-radius: 50%;
    display: inline-flex; justify-content: center; align-items: center;
    font-weight: bold; margin: 3px; font-size: 0.9em; cursor: default;
    position: relative; /* For pending/locked icons */
}
.dropped-token.dropped-snap { animation: dropSnapEffect 0.3s ease-out; }
@keyframes dropSnapEffect {
    0% { transform: scale(1.2); opacity: 0.7; }
    50% { transform: scale(0.95); }
    100% { transform: scale(1); opacity: 1; }
}
.dropped-token.pending-confirmation { opacity: 0.75; }
.dropped-token.pending-confirmation::after {
    content: '⏳'; position: absolute; top: -5px; right: -5px;
    font-size: 10px; background: white; border-radius: 50%; padding: 1px 2px;
    box-shadow: 0 0 3px black;
}
.dropped-token.locked-on-card { opacity: 1; }
.dropped-token.locked-on-card::after {
    content: '🔒'; position: absolute; top: -5px; right: -5px; font-size: 10px;
    background: white; border-radius: 50%; padding: 1px 2px; box-shadow: 0 0 3px black;
}
.dropped-token.animate-lock-stamp { animation: lockStampEffect 0.25s ease-out; }
@keyframes lockStampEffect {
    0% { transform: scale(1.3); opacity: 0.6; }
    100% { transform: scale(1); opacity: 1; }
}
.dropped-token.highlight-user-choice { box-shadow: 0 0 8px 3px #FFFFAA; }


/* --- Game Board Area --- */
.game-board-surface {
    display: flex; justify-content: space-around; flex-wrap: wrap;
    margin-bottom: 25px;
    background-image: url('assets/textures/cardboard_grain.png'); /* CREATE THIS */
    background-color: #d2b48c;
    padding: 20px; border-radius: 10px;
    border: 5px solid #8b4513;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3), inset 0 0 10px rgba(0,0,0,0.1);
}
.map-track {
    flex-basis: calc(50% - 20px); min-width: 250px; padding: 15px;
    background-color: #f5f5dc; border: 2px solid #a0522d;
    border-radius: 6px; margin: 5px; box-sizing: border-box;
}
.map-label { font-weight: bold; margin-bottom: 10px; color: #495057; font-size: 1.1em; }
.map-track .track-line-container {
    width: 100%; background-color: #ffffff;
    border: 3px solid #704214; /* Darker, more defined */
    border-radius: 20px; height: 30px; position: relative;
    margin-bottom: 8px; overflow: hidden;
    box-shadow: inset 0 1px 3px rgba(0,0,0,0.2);
    /* Dashed lines for conceptual spaces */
    background-image: repeating-linear-gradient(to right,
        transparent, transparent 18px, /* Adjust segment width as needed */
        rgba(0,0,0,0.08) 18px, rgba(0,0,0,0.08) 20px
    );
}
.track-line { position: relative; width: 100%; height: 100%; }

.map-space {
    font-weight: bold; color: #fff; background-color: #607d8b;
    padding: 5px 10px; border-radius: 4px; margin: 5px 0; display: inline-block;
    font-family: 'Luckiest Guy', cursive;
}
.map-space-start { background-color: #4caf50; padding: 8px 15px; }
.map-space-start::before { content: "🏁"; margin-right: 5px; }
.map-space-finish { background-color: #f44336; }
.map-space-finish::before { content: "🏆"; margin-right: 5px; }
.map-space-finish.glowing { animation: glowingFinish 1.2s infinite ease-in-out; }
@keyframes glowingFinish {
    0%, 100% { box-shadow: 0 0 8px #f44336, 0 0 15px #f44336; text-shadow: 0 0 5px #fff; }
    50% { box-shadow: 0 0 15px #ff7961, 0 0 25px #ff7961; text-shadow: 0 0 10px #fff; }
}

.checkpoint-marker {
    position: absolute; top: 50%; transform: translateY(-50%);
    width: 28px; height: 28px; background-color: #03a9f4;
    border: 2px solid white; border-radius: 50%; z-index: 1;
    display: flex; align-items: center; justify-content: center;
    font-size: 16px; box-shadow: 0 0 5px #03a9f4;
}
.checkpoint-marker.glowing-border { animation: glowingCheckpoint 2s infinite ease-in-out; }
@keyframes glowingCheckpoint {
    0%, 100% { box-shadow: 0 0 5px #03a9f4, 0 0 10px #03a9f4; }
    50% { box-shadow: 0 0 10px #81d4fa, 0 0 18px #81d4fa; }
}
.shield-visual { /* For safe space interaction */
    position:absolute; width: 40px; height: 40px;
    border:3px solid skyblue; border-radius:50%;
    top: 50%; left: 50%; transform: translate(-50%, -50%);
    animation: shieldActivate 0.6s ease-out forwards;
    pointer-events: none; z-index: 5;
}
@keyframes shieldActivate {
    0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; border-width: 6px; }
    50% { opacity: 1; border-width: 3px; box-shadow: 0 0 15px skyblue; }
    100% { transform: translate(-50%, -50%) scale(1.5); opacity: 0; border-width: 1px; }
}


.player-marker {
    width: 32px; height: 32px;
    border-radius: 50%; color: white; text-align: center;
    font-weight: bold; font-size: 1em;
    position: absolute; top: -1px; left: 0%;
    transition: left 0.5s ease-in-out; /* Default for JS direct manipulation if not hopping */
    z-index: 2;
    box-shadow: 0 2px 4px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.3);
    animation: pawnIdle 2s infinite ease-in-out;
    background-color: transparent; /* For image pawns */
    line-height: normal;
    display: flex; align-items: center; justify-content: center;
}
.player-marker img { max-width: 100%; max-height: 100%; object-fit:contain; }
.player-marker::after { /* Glow under base */
    content: ''; position: absolute; bottom: -3px; left: 50%;
    transform: translateX(-50%); width: 20px; height: 5px;
    background: radial-gradient(ellipse at center, var(--pawn-glow-color, rgba(255,255,255,0.5)) 0%, transparent 70%);
    border-radius: 50%; z-index: -1;
}
@keyframes pawnIdle {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-3px); }
}
@keyframes pawnActivateWiggle { 0%{transform:rotate(-8deg) scale(1.1)} 50%{transform:rotate(8deg) scale(1.1)} 100%{transform:rotate(0) scale(1)} }
.player-marker.activating { animation: pawnActivateWiggle 0.3s ease-in-out; }
.player-marker.hopping-effect { /* For JS-driven hop */
    animation: pawnHopBounce 0.1s ease-out;
}
@keyframes pawnHopBounce { 0% {transform:translateY(-5px);} 100% {transform:translateY(0);} }

.pawn-trail-particle { /* For JS-driven trail */
    position: absolute; width: 8px; height: 8px; border-radius: 50%;
    opacity: 0.7; pointer-events: none;
    animation: pawnTrailFade 0.5s linear forwards;
}
@keyframes pawnTrailFade { to { opacity:0; transform: scale(0.3); } }

#human-marker { /* Default, JS overrides with playerPawnConfig */
    /* background-color: #007bff;  Now set by JS */
}
#ai-marker {
    /* background-color: #dc3545; Now set by JS for image */
}
.map-position-text { font-size: 0.95em; text-align: right; color: #495057; margin-top: 5px; }


/* --- Question Card Area --- */
#card-display-area {
    display: flex; justify-content: space-around; align-items: stretch;
    margin-bottom: 20px; min-height: 220px; /* Increased height */
    background-color: #37474f; padding: 20px; border-radius: 8px;
    box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
    position: relative; /* For deck source visuals */
    transition: transform 0.4s ease-out; /* For focus zoom */
}
#card-display-area.zoomed-in-focus { transform: scale(1.03); }
#card-display-area.is-dragging-over-cards .card-slot:not(.drag-over) {
    opacity: 0.6; transform: scale(0.98);
    transition: opacity 0.3s, transform 0.3s;
}
.deck-source-visual {
    position: absolute; width: 80px; height: 110px;
    background-color: #ccc; border: 2px solid #555; border-radius:5px;
    box-shadow: 2px 2px 5px rgba(0,0,0,0.3);
    background-image: url('assets/images/card_back_deck.png'); /* CREATE THIS */
    background-size: cover;
}
#deck-source-1 { top: -30px; left: 10%; transform: rotate(-5deg); }
#deck-source-2 { top: -40px; left: 50%; transform: translateX(-50%) rotate(2deg); }
#deck-source-3 { top: -30px; right: 10%; transform: rotate(5deg); }

.card-label { font-weight: bold; color: #cfd8dc; margin-bottom: 8px; font-size: 0.9em; text-transform: uppercase; }
.card-slot {
    border: none; border-radius: 10px; padding: 0; width: 30%;
    background-color: #546e7a;
    box-shadow: inset 2px 2px 5px rgba(0,0,0,0.3), 0 1px 0 rgba(255,255,255,0.1);
    display: flex; flex-direction: column; justify-content: space-between;
    transition: border-color 0.2s ease, box-shadow 0.2s ease, opacity 0.3s, transform 0.3s;
    position: relative;
    overflow: hidden; /* For animations */
}
.card-slot.disabled { opacity: 0.7; pointer-events: none; }
.card-slot.drag-over {
    animation: pulseCardSlotBorder 1s infinite ease-in-out;
}
@keyframes pulseCardSlotBorder {
    0% { box-shadow: 0 0 10px 3px #00A9FF, inset 2px 2px 5px rgba(0,0,0,0.3); }
    50% { box-shadow: 0 0 20px 6px #007bff, inset 2px 2px 5px rgba(0,0,0,0.3); }
    100% { box-shadow: 0 0 10px 3px #00A9FF, inset 2px 2px 5px rgba(0,0,0,0.3); }
}
.card-slot.drag-over .scenario-text {
    font-size: 1.05em; color: #FFF !important;
    transition: font-size 0.2s, color 0.2s;
}

.card-face {
    padding: 15px; min-height: 120px; display: flex; flex-direction: column;
    justify-content: space-between; position: relative; flex-grow: 1;
    background-size: cover; background-position: center; border-radius: इन्हेरिट; /* For card artwork */
}
.card-face::before { /* For empty slot pattern */
    content: ''; position: absolute; top:0; left:0; width:100%; height:100%;
    background-image: url('assets/textures/empty_card_slot_pattern.png'); /* CREATE THIS */
    background-repeat: repeat; opacity: 0.05; z-index: 0; border-radius: inherit;
    display: block;
}
.card-face.populated::before { display: none; } /* JS adds .populated */

.card-category-icon {
    position: absolute; top: 5px; left: 5px; width: 30px; height: 30px;
    z-index: 2;
    /* background-color: rgba(255,255,255,0.7); border-radius: 50%; padding:2px; */
}
.card-category-icon img { width: 100%; height: 100%; }

.card-slot .scenario-text {
    font-size: 1em; margin-bottom: 10px; flex-grow: 1; color: #eceff1;
    background-color: rgba(0,0,0,0.4); padding: 5px; border-radius: 3px; z-index: 1; position:relative;
}
.death-toll-placeholder { /* Graphic Placeholder */
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background-color: rgba(0,0,0,0.6);
    background-size: 60%; background-repeat: no-repeat; background-position: center;
    color: white; display: flex; align-items: center; justify-content: center;
    font-size: 3em; font-weight: bold; border-radius: inherit;
    transition: opacity 0.5s ease, transform 0.5s ease;
    z-index: 5;
    /* JS sets background-image: url('assets/images/placeholder_qmark_bones.png') or vault.png */
}
.death-toll-placeholder.revealing-default { /* Current animation */
    animation: placeholderDefaultReveal 0.6s forwards;
}
@keyframes placeholderDefaultReveal {
    0% { opacity: 1; transform: scale(1) rotateY(0deg); }
    100% { opacity: 0; transform: scale(1.2) rotateY(90deg); }
}
.death-toll-placeholder.revealing-shatter {
    animation: placeholderShatterReveal 0.7s forwards;
}
@keyframes placeholderShatterReveal {
    0% { opacity: 1; transform: scale(1) rotate(0); clip-path: inset(0% 0% 0% 0%); }
    50% { opacity: 0.8; transform: scale(1.1) rotate(5deg); }
    100% { opacity: 0; transform: scale(0.5) rotate(-15deg); clip-path: inset(50% 50% 50% 50%); }
}
.death-toll-placeholder.hidden { display: none !important; }

.card-slot .casualty-text {
    font-size: 1.8em; font-weight: bold; color: #ffeb3b; text-align: center;
    padding: 10px 0; margin-top: 10px; background-color: rgba(0,0,0,0.2);
    border-radius: 4px; z-index: 1;
    transition: color 0.3s;
}
/* Conditional casualty text styling */
.casualty-text.toll-low { color: #81c784; } /* Light Green */
.casualty-text.toll-mid { color: #fff176; } /* Light Yellow */
.casualty-text.toll-high { color: #e57373; } /* Light Red */
.casualty-text.toll-extreme-glow {
    text-shadow: 0 0 6px currentColor, 0 0 12px currentColor, 0 0 18px white;
}

.card-slot .dropped-token-indicator {
    margin-top: 10px; min-height: 20px; padding: 5px 0;
    font-size: 0.9em; color: #bbdefb; background-color: rgba(0,0,0,0.1);
}
.card-slot .token-count-on-card { font-weight: bold; }
.card-slot .dropped-tokens-visual-area {
    padding-top: 5px; min-height: 40px; display: flex;
    flex-wrap: wrap; justify-content: center; align-items: center;
}
.most-deaths-banner-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 10; }
.most-deaths-banner {
    position: absolute; top: -15px; left: 50%; transform: translateX(-50%) rotate(-7deg);
    background: linear-gradient(135deg, gold, orange); color: black;
    padding: 4px 15px; font-weight: bold; font-size: 0.9em; border-radius: 4px;
    box-shadow: 1px 1px 3px rgba(0,0,0,0.5);
    animation: bannerSwoopIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    font-family: 'Bangers', cursive; letter-spacing: 1px;
}
@keyframes bannerSwoopIn { from { opacity:0; transform: translateX(-50%) translateY(-30px) rotate(-20deg) scale(0.3); } }

.card-particle-container { position:absolute; top:0;left:0;width:100%;height:100%; pointer-events:none; z-index:9; }
.particle-deadliest-card { /* JS adds particles here */
    position: absolute; border-radius: 50%;
    animation: particleBurst 0.8s ease-out forwards;
}
@keyframes particleBurst {
    0% { opacity:1; transform: scale(1); }
    100% { opacity:0; transform: scale(0.3) translate(var(--tx), var(--ty)); }
}

.card-slot.dealing {
    animation: cardDealAnim 0.5s ease-out forwards;
    opacity: 0;
    transform: translateX(-100px) rotateY(-90deg); /* Start off-screen */
    /* filter: blur(2px); */ /* Motion blur during deal */
}
@keyframes cardDealAnim {
    /* ... existing, ensure it ends with filter: blur(0); */
    90% { transform: translateX(0) rotateY(0) scale(1.05); }
    100% { opacity: 1; transform: translateX(0) rotateY(0) scale(1); /* filter: blur(0); */ }
}
#card-slot-1.dealing { animation-delay: 0s; }
#card-slot-2.dealing { animation-delay: 0.2s; }
#card-slot-3.dealing { animation-delay: 0.4s; }

.card-slot.clearing.clear-fly-off { animation: cardClearFlyOff 0.5s ease-in forwards; }
@keyframes cardClearFlyOff { to { opacity: 0; transform: translateY(-150px) rotate(15deg) scale(0.7); } }
.card-slot.clearing.clear-slide-discard { animation: cardClearSlideToDiscard 0.6s ease-in forwards; }
@keyframes cardClearSlideToDiscard { to { opacity: 0; transform: translateX(150%) rotate(20deg); } }
.card-slot.clearing { /* Default clearing */ animation: cardClearAnim 0.5s ease-in forwards; }
@keyframes cardClearAnim { from { opacity: 1; transform: translateY(0) scale(1); } to { opacity: 0; transform: translateY(50px) scale(0.8); } }


.card-slot.deadliest-card {
    border: 4px solid gold !important;
    box-shadow: 0 0 15px gold, 0 0 25px gold, inset 2px 2px 5px rgba(0,0,0,0.3);
    animation: pulseGold 1s infinite;
    transform: scale(1.03); /* Slightly emphasize */
}
@keyframes pulseGold {
    0%, 100% { border-color: gold; transform: scale(1.03); }
    50% { border-color: #ffd700; transform: scale(1.05); }
}

.player-bet-indicator {
    position: absolute; top: 5px; right: 5px; font-size: 1.5em; z-index: 6;
    text-shadow: 0 0 3px black; opacity:0; transform: scale(0.5);
}
.player-bet-indicator.visible { animation: iconAppearStamp 0.4s ease-out forwards; }
.player-bet-indicator.correct::before { content: '✔'; color: lightgreen; }
.player-bet-indicator.incorrect::before { content: '✖'; color: lightcoral; }


/* --- Game Buttons --- */
button { /* General style for non-menu buttons if any left */
    padding: 10px 15px; font-size: 1em; color: #fff;
    background-color: #007bff; border: none; border-radius: 4px;
    cursor: pointer; margin: 5px;
}
button:hover { background-color: #0056b3; }
button:disabled { background-color: #ccc; cursor: not-allowed; opacity: 0.7; }

#place-bet-btn { /* Confirm Bet Button */
    padding: 12px 25px; font-size: 1.1em; background-color: #4CAF50;
    font-family: 'Luckiest Guy', cursive; text-transform: uppercase; letter-spacing: 1px;
    box-shadow: 0 3px 5px rgba(0,0,0,0.2), inset 0 -2px 0 rgba(0,0,0,0.2);
    animation-duration: 1.5s; animation-iteration-count: infinite;
}
#place-bet-btn:not(:disabled):not(.confirmed) { animation-name: pulseButtonText; }
@keyframes pulseButtonText { 0%, 100% { opacity: 1; } 50% { opacity: 0.8; } }
#place-bet-btn:hover:not(:disabled) { background-color: #45a049; transform: translateY(-2px); box-shadow: 0 5px 8px rgba(0,0,0,0.25), inset 0 -1px 0 rgba(0,0,0,0.1); }
#place-bet-btn:active:not(:disabled) { transform: translateY(1px); box-shadow: 0 2px 3px rgba(0,0,0,0.2), inset 0 -1px 0 rgba(0,0,0,0.3); }
#place-bet-btn.confirmed { background-color: #ff9800; cursor: default; }
#place-bet-btn.confirmed:hover { background-color: #f57c00; }

#next-round-btn { /* Reuse menu button style */
    /* Styles are inherited from .menu-button class in HTML */
    background-color: #28a745;
}
#next-round-btn:hover:not(:disabled) { background-color: #218838; }


/* --- AI Bet Display & Results Area --- */
#ai-bet-display, #results-area {
    margin-top: 20px; padding: 15px; background-color: rgba(233,236,239, 0.9);
    border-radius: 4px;
    transition: opacity 0.3s, transform 0.3s;
}
.fading-out-ai-info { animation: aiInfoFade 0.3s forwards; } /* JS adds this */
@keyframes aiInfoFade {to {opacity:0; transform:scale(0.8);}}
#ai-bet-display p, #results-area p { margin: 0; line-height: 1.5; }


/* --- Phase 9: Game Over Screen --- */
#game-over-screen {
    display: none; flex-direction: column; align-items: center; justify-content: center;
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background-color: rgba(0, 0, 0, 0.9); z-index: 1000;
    text-align: center; color: white; padding: 20px; box-sizing: border-box;
}
.game-over-content {
    background-color: #263238; padding: 40px; border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.5); max-width: 90%; position:relative;
}
.winner-declaration-banner {
    /* For "WINNER!" text, could be a separate graphical banner element */
}
#game-over-message {
    font-family: 'Bangers', cursive; font-size: 3.5em; /* Larger, themed */
    color: #ffeb3b; margin-bottom: 20px; text-transform: uppercase;
    word-wrap: break-word;
    text-shadow: 0 0 5px #fff, 0 0 10px #ffeb3b, 0 0 20px #ffeb3b, 0 0 30px #ff5722; /* Glow */
}
#final-scores-summary { margin-bottom: 30px; font-size: 1.2em; }
.game-over-buttons { display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; }
.game-over-buttons .menu-button { margin: 0; }

/* Confetti & Fireworks */
.confetti-container, .fireworks-container {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    overflow: hidden; pointer-events: none; z-index: -1;
}
.confetto { /* JS creates these */
    position: absolute; width: 10px; height: 10px;
    /* background-color: red; JS sets this or uses image */
    opacity: 0; animation: fall 5s linear forwards;
    background-size: contain; background-repeat: no-repeat;
}
@keyframes fall {
    0% { transform: translateY(-10vh) rotate(0deg); opacity: 1; }
    99% { opacity: 1; }
    100% { transform: translateY(110vh) rotate(720deg); opacity: 0; }
}
.firework-particle { /* JS creates these */
    position: absolute; border-radius: 50%;
    /* JS sets background, size, animation based on firework type */
}

/* Tooltip */
#game-tooltip {
    /* Styles are in HTML for now for simplicity, can move here */
}